@import "../theme-base";

// palette generated by https://learnui.design/tools/data-color-picker.html#palette
@employee-color: #E8E8E8;
@base-color: #003f5c;
@project-manager-color: #003f5c;
@instructor-color: #2f4b7c;
@author-color: #665191;
@lead-developer-color: #a05195;
@developer-color: #d45087;
@support-color: #f95d6a;
@architect-color: #ff7c43;
@reviewer-color: #ffa600;

@expert-color: #486d24;
@proficient-color: #899e71;
@competent-color: #cbd1c3;

@summary-expert-color: #b5de8a;
@summary-proficient-color: rgb(172, 202, 225);
@summary-competent-color: #e8e3ae;

@default-stripe-width: 2 * @small_spacing;
@default-top-spacing: 2 * @standard_spacing;
@default-stripe-angle: -45deg;
@title_color: black;
@link_color: @title_color;
@text_color: #444;
@first_year: 1985;
@last_year: 2023;
@current_year: 2022;
@years_per_block: 5;
@year_count: @last_year - @first_year;

@resume_spacing: 1.5 * @standard_spacing;
@resume_grid_spacing: 2.5 * @standard_spacing;

@minimum_width: 0;
@columns_per_year: 2;
@one_year_percent: 100 / @year_count;
@total_columns: @year_count * @columns_per_year;
@half_year: @columns_per_year / 2;

@h1_font_size: 167%;
@h2_font_size: 150%;
@h4_font_size: 120%;

.set-basis(@numerator, @denominator)
{
  flex-basis: calc(~"("@numerator~" / "@denominator~") * 100%");
}

.main-box
{
  max-width: 240mm;
}

h2
{
  border: none;
}

h3, h4
{
  margin-top: @small_spacing;
}

.header, .footer
{
  display: none;
}

.text-flow .timeline
{
  position: relative;

  .timeline-box
  {
    position: relative;

    table
    {
      display: block;
      padding-top: @default-top-spacing;

      th
      {
        border: none;
      }

      thead
      {
        display: none;
      }

      tbody
      {
        display: block;

        tr
        {
          display: block;

          th:first-child
          {
            display: block;
            position: absolute; left: -15ex;
            width: 14ex;
            text-align: right;
            font-size: 80%;
          }

          td
          {
            &:nth-child(2)
            {
              display: grid;

              span:first-child:not(:empty)
              {
                text-align: right;
                padding-right: .5em;
                box-sizing: border-box;
              }

              span:last-child:not(:empty)
              {
                display: block;
                height: 100%;
                padding-left: .5em;
                //box-sizing: border-box;
              }

              //span:nth-child(3)
              //{
              //  white-space: nowrap;
              //}

              &.level-expert:after
              {
                /*TODO Fix these appends*/

                content: " (Expert)";
              }

              &.level-proficient:after
              {
                content: " (Proficient)";
              }

              &.level-competent:after
              {
                content: " (Competent)";
              }
            }

            &:nth-child(3)
            {
              display: none;
            }

          }
        }
      }
    }
  }

  .legend
  {
    position: absolute;
    font-size: @micro_font_size;
    left: @standard_spacing;
    top: @standard_spacing;

    &.early
    {
      left: auto;
      right: @standard_spacing;
    }

    caption:after
    {
      content: attr(title);
    }

    th:after
    {
      content: attr(title);
    }

    td
    {
      width: @default-stripe-width * 2;
      line-height: @compressed_text_flow_line_height;
      padding: 0;
    }
  }

  .years
  {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: -1;

    > div
    {
      padding-left: @small_spacing;
      border-left: @hairline_border_width solid @standard_border_color;
      box-sizing: border-box;
      opacity: .6;

      &:last-child
      {
        border-right: @hairline_border_width solid @standard_border_color;
      }

      &:after
      {
        content: attr(title);
      }
    }
  }
}

.text-flow
{
  section
  {
    div
    {
      &.contact
      {
        display: flex;

        div
        {
          flex: 2;

          h2
          {
            margin-top: @standard_spacing;
            font-size: @h1_font_size;

            &+ul
            {
              margin-top: 0;
            }
          }
        }

        ul
        {
          flex: 2;
          list-style: none;
          padding-left: 0;
          margin-bottom: 0;
          margin-top: @standard_spacing;

          li
          {
            padding-left: 0;
          }
        }

        img
        {
          margin-top: @standard_spacing;
          height: 120px;
        }
      }
    }
  }
}

@media screen and (min-width: 900px)
{
  .grid > div
  {
    width: 100%;
  }
}

@media screen and (min-width: 450px)
{
  .grid > div
  {
    width: 100%;
  }
}

section
{
  &:first-child
  {
    > h1
    {
      display: none;
    }
  }

  h1:first-child
  {
    flex: 1;
    font-variant: small-caps;
    margin-right: @resume_spacing;
  }

  h2:first-child
  {
    margin-top: 0;
  }

  p:first-child,
  ul:first-child
  {
    //margin-top: @resume_spacing;
  }

  a
  {
    &:link, &:visited
    {
      text-decoration: underline dotted #AAA;
    }
  }

  > div
  {
    > h2:first-child
    {
      margin-top: @resume_spacing;
    }

    &:first-child
    {
      flex: 1;
      margin-top: 0;
      margin-right: @resume_spacing;

      > h2
      {
        margin-top: 0;
      }
    }
  }

  div
  {
    flex: 5;
    margin-top: 0;

    &.grid
    {
      margin-top: @standard_spacing;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-column-gap: @standard_spacing;
      grid-row-gap: 0;

      &.employment
      {
        grid-template-columns: repeat(3, 1fr);
      }

      > div
      {
        h3:first-child
        {
          margin-top: 0;
        }
      }
    }
  }

  table.list
  {
    display: block;
    padding-left: @ul_indent;

    tbody
    {
      display: block;
    }

    tr
    {
      &:first-child
      {
        display: none;
      }

      display: list-item;
      scroll-padding-inline-start: @li_indent;
      margin-bottom: 2px;
      position: relative; // for positioning the language progress bars

      th, td
      {
        display: inline;
        padding: 3px;
      }

      th
      {
        border: none;

        &:after
        {
          content: ": ";
        }
      }

      td
      {
        font-size: @detail_font_size;
        text-align: right;  // Use flex?
      }

      td:after
      {
        content: " ";
        position: absolute;
        left: 0;
        z-index: -1;
        height: 90%;
        margin: 1px 0;
      }

      &.native, &.expert
      {
        td:after
        {
          background-color: @summary-expert-color;
          width: 100%;
        }
      }

      &.fluent, &.proficient
      {
        td:after
        {
          background-color: @summary-proficient-color;
          width: 85%;
        }
      }

      &.mixed, &.competent
      {
        td:after
        {
          background-color: @summary-competent-color;
          width: 50%;
        }
      }
    }
  }
}

ul.employment
{
  list-style: none;
  padding-inline-start: 0;

  li
  {
    display: inline;

    &:after
    {
      content: "; ";
    }
  }

  li:last-child:after
  {
    content: "";
  }
}

.page-break > h2
{
  border-top: 1px solid silver;
  padding-top: 5px;
  margin-top: 20px;
}

@media (min-width: @min-width-for-columns)
{
  section
  {
    display: flex;
  }
}

@media (max-width: @min-width-for-columns)
{
  .text-flow
  {
    h1
    {
      border-top: 1px solid silver;
      background-color: #EEE;
      border-bottom: 1px solid silver;
      padding: 5px 0;
    }

    .page-break > h2
    {
      border-top: 1px solid silver;
      background-color: #EEE;
      border-bottom: 1px solid silver;
      padding: 5px 0;
    }

    .timeline
    {
      .years
      {
        font-size: @micro_font_size;
      }

      .timeline-box
      {
        table tbody tr
        {
          td
          {
            font-size: @micro_font_size;
          }

          th:first-child
          {
            display: none;
          }
        }
      }
    }

    table.basic.legend
    {
      position: relative;
      margin: 2 * @standard_spacing 0;

      &.early
      {
        left: @standard_spacing;
        right: auto;
      }
    }

    section div.contact
    {
      display: block;
    }

    section div.grid
    {
      grid-template-columns: 1fr;

      &.projects ul.details li
      {
        list-style-type: none;
      }

      &.employment
      {
        grid-template-columns: 1fr;
      }
    }
  }
}

@media (max-width: 320px)
{
  .text-flow
  {
    .timeline
    {
      .years
      {
        font-size: @nano_font_size;
      }

      .timeline-box
      {
        table tbody tr
        {
          td
          {
            font-size: @nano_font_size;
          }

          th:first-child
          {
            display: none;
          }
        }
      }
    }
  }
}

@media print
{
  body
  {
    .page
    {
      .header
      {
        .nav-box
        {
          display: none;
        }
      }

      .main-box {
        max-width: none;
      }

      .text-flow {
        line-height: 130%;
      }

      section
      {
        display: block;

        div
        {
          .timeline
          {
            left: 100px;
            margin-right: 100px;
          }

          &.grid
          {
            > div
            {
              width: 100%;
            }
          }
        }
      }
    }
  }

  .page-break
  {
    page-break-before: always;

    > h2
    {
      border: none;
    }
  }
}

.projects
{
  ul
  {
    padding: 0;
    margin: 0;

    li
    {
      padding: 0;
      margin: 3px 0; // Need to tighten a bit from @small_spacing for printing
    }
  }
}

.use-translucent-background(@opacity, @background-color: @base-color)
{
  .make-background-container();
  background-color: mix(@background-color, white, @opacity * 100);
}

.use-background(@color)
{
  .make-background-container();
  background-color: @color;
}

.make-background-container()
{
  margin: @hairline_border_width 0;
}

.level-expert
{
  .use-background(@expert-color);
}

.level-proficient
{
  .use-background(@proficient-color);
}

.level-competent
{
  .use-background(@competent-color);
}

.support
{
  .use-background(@support-color);
}

.developer
{
  .use-background(@developer-color);
}

.lead-developer
{
  .use-background(@lead-developer-color);
}

.author
{
  .use-background(@author-color);
}

.reviewer
{
  .use-background(@reviewer-color);
}

.architect
{
  .use-background(@architect-color);
}

.instructor
{
  .use-background(@instructor-color);
}

.project-manager
{
  .use-background(@project-manager-color);
}

.employee
{
  position: absolute;
  width: 100%;
  height: calc(100%~" - "@default-top-spacing);
  z-index: -2;

  span:nth-child(2)
  {
    .use-background(@employee-color);
  }
}

.two-color-diagonal-stripes(@first-color, @second-color, @stripe-width: @default-stripe-width, @stripe-angle: @default-stripe-angle)
{
  background: repeating-linear-gradient(
    @stripe-angle,
    @first-color,
    @first-color @stripe-width,
    @second-color @stripe-width,
    @second-color 2 * @stripe-width,
  );
}

.three-color-diagonal-stripes(@first-color, @second-color, @third-color, @stripe-width: @default-stripe-width, @stripe-angle: @default-stripe-angle)
{
  background: repeating-linear-gradient(
    @stripe-angle,
    @first-color,
    @first-color @stripe-width,
    @second-color @stripe-width,
    @second-color 2 * @stripe-width,
    @third-color 2 * @stripe-width,
    @third-color 3 * @stripe-width
  );
}

.four-color-diagonal-stripes(@first-color, @second-color, @third-color, @fourth-color, @stripe-width: @default-stripe-width, @stripe-angle: @default-stripe-angle)
{
  background: repeating-linear-gradient(
    @stripe-angle,
    @first-color,
    @first-color @stripe-width,
    @second-color @stripe-width,
    @second-color 2 * @stripe-width,
    @third-color 2 * @stripe-width,
    @third-color 3 * @stripe-width,
    @fourth-color 3 * @stripe-width,
    @fourth-color 4 * @stripe-width
  );
}

.project-manager.architect.lead-developer.support
{
  .four-color-diagonal-stripes(@architect-color, @project-manager-color, @lead-developer-color, @support-color);
}

.project-manager.architect.developer.support
{
  .four-color-diagonal-stripes(@architect-color, @project-manager-color, @developer-color, @support-color);
}

.project-manager.architect.lead-developer
{
  .three-color-diagonal-stripes(@architect-color, @project-manager-color, @lead-developer-color);
}

.project-manager.architect.developer
{
  .three-color-diagonal-stripes(@architect-color, @project-manager-color, @developer-color);
}

.architect.lead-developer
{
  .two-color-diagonal-stripes(@architect-color, @lead-developer-color);
}

.project-manager.developer
{
  .two-color-diagonal-stripes(@project-manager-color, @developer-color);
}

.project-manager.lead-developer
{
  .two-color-diagonal-stripes(@project-manager-color, @lead-developer-color);
}

.project-manager.support
{
  .two-color-diagonal-stripes(@project-manager-color, @support-color);
}

.project-manager.author
{
  .two-color-diagonal-stripes(@project-manager-color, @author-color);
}

.architect.developer
{
  .two-color-diagonal-stripes(@architect-color, @developer-color);
}

.architect.reviewer
{
  .two-color-diagonal-stripes(@architect-color, @reviewer-color);
}

.project-manager.lead-developer.support
{
  .three-color-diagonal-stripes(@project-manager-color, @lead-developer-color, @support-color);
}

.project-manager.developer.support
{
  .three-color-diagonal-stripes(@project-manager-color, @developer-color, @support-color);
}

.lead-developer.support
{
  .two-color-diagonal-stripes(@lead-developer-color, @support-color);
}

.developer.support
{
  .two-color-diagonal-stripes(@developer-color, @support-color);
}

.single-line
{
  > div:nth-child(2)
  {
    margin-top: -@default-top-spacing;
    color: transparent;
  }
}